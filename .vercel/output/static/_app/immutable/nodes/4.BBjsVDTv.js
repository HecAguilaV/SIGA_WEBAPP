import{f as z,a as M}from"../chunks/CqfPujLJ.js";import"../chunks/dDVp0x_e.js";import{p as ut,k as m,o as mt,q as w,v as ft,g as t,h as J,w as o,x as v,m as u,a9 as pt,y as a,s as d,b as k,z as vt,B as It}from"../chunks/DhgA-MYx.js";import{s as x,e as gt}from"../chunks/GTjz6jRx.js";import{e as ht,i as bt,a as K,s as _t,d as Rt}from"../chunks/3RfNQFC1.js";import{i as xt}from"../chunks/BxwXIULK.js";import{s as St,a as Vt}from"../chunks/Bgr80FTy.js";import{G as Lt}from"../chunks/DFqi5821.js";import{C as qt}from"../chunks/CFNrZGOd.js";import{o as At,a as Et}from"../chunks/U2GiaHM_.js";import{p as L,b as Mt}from"../chunks/EsF0eeuf.js";var wt=z("<button> </button>"),zt=z('<div class="contenedor-grafico-multiple svelte-k78rsd"><div class="selector-locales mb-4 svelte-k78rsd"></div> <div class="contenedor-grafico svelte-k78rsd"><canvas></canvas></div></div>');function Nt(N,$){ut($,!1);let l=L($,"titulo",8,""),R=L($,"dias",24,()=>[]),S=L($,"locales",24,()=>[]),f=L($,"datosGrafico",24,()=>[]),G=L($,"nombreGrafico",8,""),p=u(new Map),c=u(),g=u();const D=(r,s=1)=>{const i=r.replace("#","").trim(),_=(i.length===3?i.split("").map(E=>`${E}${E}`).join(""):i).padEnd(6,"0"),q=parseInt(_.slice(0,2),16),A=parseInt(_.slice(2,4),16),V=parseInt(_.slice(4,6),16);return`rgba(${q}, ${A}, ${V}, ${s})`},T=()=>{if(!t(c))return;const r=typeof document<"u"&&getComputedStyle(document.documentElement).getPropertyValue("--color-texto")||"#2c3e50",s=f().filter(h=>t(p).get(h.localId)).map(h=>({label:h.nombre,data:h.valores,borderColor:h.color,backgroundColor:D(h.color,.1),fill:!0,tension:.4,pointRadius:5,pointBackgroundColor:h.color,pointBorderColor:"#ffffff",pointBorderWidth:2,pointHoverRadius:7,borderWidth:2})),i=t(c);d(g,new qt(i,{type:"line",data:{labels:R(),datasets:s},options:{responsive:!0,maintainAspectRatio:!1,interaction:{intersect:!1,mode:"index"},plugins:{legend:{position:"top",labels:{color:r,usePointStyle:!0,padding:15}},title:{display:!!l(),text:`${l()}${G()?` (${G()})`:""}`,color:r,font:{size:14}}},scales:{y:{beginAtZero:!0,ticks:{color:r},grid:{color:D(r,.1)}},x:{ticks:{color:r},grid:{display:!1}}}}}))};At(()=>{T()}),Et(()=>{var r;(r=t(g))==null||r.destroy()});const W=r=>{if(t(p).set(r,!t(p).get(r)),d(p,t(p)),t(g)){const s=f().filter(i=>t(p).get(i.localId)).map(i=>({label:i.nombre,data:i.valores,borderColor:i.color,backgroundColor:D(i.color,.1),fill:!0,tension:.4,pointRadius:5,pointBackgroundColor:i.color,pointBorderColor:"#ffffff",pointBorderWidth:2,pointHoverRadius:7,borderWidth:2}));pt(g,t(g).data.datasets=s),t(g).update()}};m(()=>(J(S()),t(p)),()=>{S().forEach(r=>{t(p).has(r.id)||t(p).set(r.id,!0)})}),m(()=>(t(g),J(f()),J(R())),()=>{t(g)&&f().length&&(pt(g,t(g).data.labels=[...R()]),t(g).update())}),mt(),xt();var y=zt(),P=o(y);ht(P,5,S,bt,(r,s)=>{var i=wt(),h=o(i,!0);a(i),w((I,_)=>{_t(i,1,I,"svelte-k78rsd"),K(i,"aria-pressed",_),x(h,(t(s),k(()=>t(s).nombre)))},[()=>(t(p),t(s),k(()=>`local-filter-btn ${t(p).get(t(s).id)?"is-active":""}`)),()=>(t(p),t(s),k(()=>t(p).get(t(s).id)))]),gt("click",i,()=>W(t(s).id)),M(r,i)}),a(P);var B=v(P,2),C=o(B);Mt(C,r=>d(c,r),()=>t(c)),a(B),a(y),w(()=>K(C,"aria-label",l())),M(N,y),ft()}var Tt=z("<button> </button>"),Wt=z('<section class="section"><div class="hero-gradient mb-6"><h1 class="title heading-gradient">Insights inteligentes</h1> <p class="subtitle">An√°lisis en tiempo real para decisiones sin fricciones. Optimiza rotaci√≥n, prev√©n quiebres.</p></div> <div class="columns is-multiline mb-6"><div class="column is-half-tablet is-one-third-desktop"><div class="insight-card"><div class="insight-header"><span class="insight-icon">‚≠ê</span> <h3 class="insight-title">Producto Estrella</h3></div> <div class="insight-content"><p class="insight-value"> </p> <p class="insight-metric"> </p> <p class="insight-description">Tu producto m√°s vendido. Asegura stock constante.</p></div></div></div> <div class="column is-half-tablet is-one-third-desktop"><div class="insight-card"><div class="insight-header"><span class="insight-icon">üìà</span> <h3 class="insight-title">Total Semanal</h3></div> <div class="insight-content"><p class="insight-value"> </p> <p class="insight-metric"> </p> <p class="insight-description"> </p></div></div></div> <div class="column is-half-tablet is-one-third-desktop"><div class="insight-card"><div class="insight-header"><span class="insight-icon">üéØ</span> <h3 class="insight-title">Recomendaci√≥n</h3></div> <div class="insight-content"><p class="insight-value">Reponer stock</p> <p class="insight-metric"> </p> <p class="insight-description">Revisa productos con stock bajo para evitar quiebres.</p></div></div></div></div> <div class="box"><h2 class="title is-4">An√°lisis Detallado</h2> <div class="box mt-5 mb-5"><h2 class="subtitle is-5">Comparativa de ventas por local (√∫ltimos 7 d√≠as)</h2> <p class="help mb-3">Selecciona/deselecciona locales para comparar desempe√±o</p> <!></div> <hr/> <h2 class="subtitle is-4 mt-5">An√°lisis por local</h2> <div class="local-selector mt-5 mb-5"></div> <div class="box mt-5"><!> <p class="help mt-3"> </p></div></div></section>');function te(N,$){ut($,!1);const l=()=>Vt(Rt,"$datosNegocio",R),[R,S]=St(),f=u(),G=u(),p=u(),c=u(),g=u(),D=u(),T=u(),W=u(),y=u(),P=u(),B=u(),C=u(),r=u();let s=u(0);const i=(e,n)=>typeof document>"u"?n:getComputedStyle(document.documentElement).getPropertyValue(e).trim()||n;m(()=>l(),()=>{d(f,l().locales??[])}),m(()=>(t(s),t(f)),()=>{!t(s)&&t(f).length&&d(s,t(f)[0].id)}),m(()=>l(),()=>{d(G,new Map((l().productos??[]).map(e=>[e.id,e])))}),m(()=>(l(),t(s),t(G)),()=>{d(p,(l().ventasSemana??[]).filter(e=>e.localId===t(s)).map(e=>{const n=t(G).get(e.productoId);return n?{...e,producto:n}:null}).filter(e=>e!==null).map(e=>e))}),m(()=>t(p),()=>{d(c,[...t(p)].sort((e,n)=>n.cantidad-e.cantidad))}),m(()=>t(c),()=>{d(g,t(c).map(e=>e.producto.nombre))}),m(()=>t(c),()=>{d(D,t(c).map(e=>e.cantidad))}),m(()=>l(),()=>{d(T,(l().ventasPorDia??[]).map(e=>e.dia))}),m(()=>l(),()=>{d(W,(l().ventasPorDia??[]).map(e=>e.totalVentas))}),m(()=>l(),()=>{d(y,[...new Set((l().ventasPorDiaYLocal??[]).map(e=>e.dia))])}),m(()=>(t(f),t(y),l()),()=>{d(P,t(f).map((e,n)=>{const b=[i("--color-secundario","#00b4d8"),i("--color-primario","#03045e"),i("--color-acento","#80ffdb")],U=t(y).map(Bt=>{const Z=(l().ventasPorDiaYLocal??[]).find(dt=>dt.dia===Bt&&dt.local===e.id);return(Z==null?void 0:Z.ventas)??0});return{localId:e.id,nombre:e.nombre,valores:U,color:b[n%b.length]}}))}),m(()=>(t(f),t(s)),()=>{d(B,(t(f).find(e=>e.id===t(s))??{}).nombre??`Local ${t(s)}`)}),m(()=>t(c),()=>{d(C,t(c).reduce((e,n)=>e+n.cantidad,0))}),m(()=>(t(c),t(C)),()=>{d(r,t(c).length?Math.round(t(C)/t(c).length):0)}),mt(),xt();var h=Wt(),I=v(o(h),2),_=o(I),q=o(_),A=v(o(q),2),V=o(A),E=o(V,!0);a(V);var Q=v(V,2),kt=o(Q);a(Q),vt(2),a(A),a(q),a(_);var j=v(_,2),X=o(j),tt=v(o(X),2),H=o(tt),$t=o(H,!0);a(H);var O=v(H,2),yt=o(O);a(O);var et=v(O,2),Ct=o(et);a(et),a(tt),a(X),a(j);var st=v(j,2),at=o(st),ot=v(o(at),2),it=v(o(ot),2),Gt=o(it);a(it),vt(2),a(ot),a(at),a(st),a(I);var rt=v(I,2),Y=v(o(rt),2),Dt=v(o(Y),4);Nt(Dt,{titulo:"Ventas diarias",get dias(){return t(y)},get locales(){return t(f)},get datosGrafico(){return t(P)},nombreGrafico:"tendencia-por-local"}),a(Y);var F=v(Y,6);ht(F,5,()=>t(f),bt,(e,n)=>{var b=Tt(),U=o(b,!0);a(b),w(()=>{_t(b,1,(t(s),t(n),k(()=>`local-btn ${t(s)===t(n).id?"is-active":""}`))),K(b,"aria-pressed",(t(s),t(n),k(()=>t(s)===t(n).id))),x(U,(t(n),k(()=>t(n).nombre)))}),gt("click",b,()=>d(s,t(n).id)),M(e,b)}),a(F);var nt=v(F,2),ct=o(nt);{let e=It(()=>`Ventas semanales por producto (${t(B)})`);Lt(ct,{get titulo(){return t(e)},get etiquetas(){return t(g)},get valores(){return t(D)},get nombreGrafico(){return`ventas-producto-${t(s)??""}`}})}var lt=v(ct,2),Pt=o(lt);a(lt),a(nt),a(rt),a(h),w(()=>{x(E,(t(c),k(()=>{var e,n;return((n=(e=t(c)[0])==null?void 0:e.producto)==null?void 0:n.nombre)??"N/A"}))),x(kt,`${t(c),k(()=>{var e;return((e=t(c)[0])==null?void 0:e.cantidad)??0})??""} unidades/semana`),x($t,t(C)),x(yt,`Promedio: ${t(r)??""} por producto`),x(Ct,`Volumen de ventas en ${t(B)??""}`),x(Gt,`Productos cr√≠ticos: ${t(c),k(()=>t(c).length)??""}`),x(Pt,`üí° Escribe al asistente: "expl√≠came el gr√°fico ventas-producto-${t(s)??""}"`)}),M(N,h),ft(),S()}export{te as component};
